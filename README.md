# Fluid symmetric cryptosystems: RC4

n = 3 <br>
23 = 8 - bitstream <br>
We form the vector S: 01234567 <br>
We choose the key: 17, K - the key vector <br>
The ASCII code of the key is: 1 → 49; 7 → 55; <br>
The key vector is: <br>

| 49 | 55 |	49 | 55 |	49 | 55 |	49 |	55 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |

<br>
We submit the values of the ASCII code of the key:
<br>

|     P    |     0     |     1     |     2     |     3     |     4     |     5     |     6     |     7     |
|----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
|     S    |     0     |     1     |     2     |     3     |     4     |     5     |     6     |     7     |
|     K    |     49    |     55    |     49    |     55    |     49    |     55    |     49    |     55    |

<br>
We perform permutations on the bits of the vector S:
<br>

Initially i = 0, j = 0.
<br>
j = (j + K [i] + S [j]) mode 8
<br>

1. i = 0, j = (0 + K [0] + S [0]) mod 8 = (0 + 49 + 0) mod 8 = 49 mod 8 = 1;<br>
   SWAP (S [i], S [j]) = SWAP (S [0], S [1]) = 10234567 = 55 49 49 55 49 55 49 55
<br>
   
|     P    |     0     |     1     |     2     |     3     |     4     |     5     |     6     |     7     |
|----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
|     S    |     1     |     0     |     2     |     3     |     4     |     5     |     6     |     7     |
|     K    |     55    |     49    |     49    |     55    |     49    |     55    |     49    |     55    |

<br>

2. i=1, j=(1+K[1]+S[1]) mod 8 = (1+49+0) mod 8 = 50 mod 8 = 2;<br>
   SWAP(S[i],S[j])=SWAP(S[1],S[2])=12034567=55 49 49 55 49 55 49 55
<br>

|     S    |     1     |     2     |     0     |     3     |     4     |     5     |     6     |     7     |
|----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
|     K    |     55    |     49    |     49    |     55    |     49    |     55    |     49    |     55    |

<br>

3. i=2, j=(2+K[2]+S[2]) mod 8 = (2+49+0) mod 8 = 51 mod 8 = 3;<br>
   SWAP(S[i],S[j])=SWAP(S[2],S[3])=12304567=55 49 55 49 49 55 49 55
<br>

|     S    |     1     |     2     |     3     |     0     |     4     |     5     |     6     |     7     |
|----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
|     K    |     55    |     49    |     55    |     49    |     49    |     55    |     49    |     55    |

<br>

4. i=3, j=(3+K[3]+S[3]) mod 8 = (3+49+0) mod 8 = 52 mod 8 = 4;<br>
   SWAP(S[i],S[j])=SWAP(S[3],S[4])=12340567=55 49 55 49 49 55 49 55
<br>

|     S    |     1     |     2     |     3     |     0     |     4     |     5     |     6     |     7     |
|----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
|     K    |     55    |     49    |     55    |     49    |     49    |     55    |     49    |     55    |

<br>

5. i=4, j=(4+K[4]+S[4]) mod 8 = (4+49+0) mod 8 = 53 mod 8 = 5;<br>
   SWAP(S[i],S[j])=SWAP(S[4],S[5])=12345067=55 49 55 49 55 49 49 55 
<br>

|     S    |     1     |     2     |     3     |     4     |     5     |     0     |     6     |     7     |
|----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
|     K    |     55    |     49    |     55    |     49    |     55    |     49    |     49    |     55    |
<br>

6. i=5, j=(5+K[5]+S[5]) mod 8 = (5+49+0) mod 8 = 54 mod 8 = 6;<br>
   SWAP(S[i],S[j])=SWAP(S[5],S[6])=12345607=55 49 55 49 55 49 49 55
<br>

|     S    |     1     |     2     |     3     |     4     |     5     |     6     |     0     |     7     |
|----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
|     K    |     55    |     49    |     55    |     49    |     55    |     49    |     49    |     55    |
<br>

7. i=6, j=(6+K[6]+S[6]) mod 8 = (6+49+0) mod 8 = 55 mod 8 = 7;<br>
   SWAP(S[i],S[j])=SWAP(S[6],S[7])=12345670=55 49 55 49 55 49 55 49
<br>

|     S    |     1     |     2     |     3     |     4     |     5     |     6     |     7     |     0     |
|----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
|     K    |     55    |     49    |     55    |     49    |     55    |     49    |     55    |     49    |

<br>

8. i=7, j=(7+K[7]+S[7]) mod 8 = (7+49+0) mod 8 = 56 mod 8 = 0;<br>
   SWAP(S[i],S[j])=SWAP(S[7],S[0])= 02345671= 49 49 55 49 55 49 55 55
<br>

|     P    |     0     |     1     |     2     |     3     |     4     |     5     |     6     |     7     |
|----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
|     S    |     0     |     2     |     3     |     4     |     5     |     6     |     7     |     1     |
|     K    |     49    |     49    |     55    |     49    |     55    |     49    |     55    |     55    |

##### ENCRYPTION

We choose a message for encryption m = Processor<br>
Initially i = 0, j = 0.<br>
i = (i + 1) mod 8 = 1 mod 8 = 1.<br>
j = (j + S [i]) mod 8 = (j + S [1]) mod 8 = (0 + 2) mod 8 = 2<br>

Calculate t:<br>
t = (S [i] + S [j]) mod 8 = (S [1] + S [2]) mod 8 = (2 + 3) mod 8 = 5<br>

Crypt r = chr (ord (m)) XOR K [t]<br>

K [t] = K [5] = (49) 2 = (00110001) 2<br>
m [0] = P → (80) 10 = (01010000) 2<br>
m [1] = r → (114) 10 = (01110010) 2<br>
m [2] = o → (111) 10 = (01101111) 2<br>
m [3] = c → (99) 10 = (01100011) 2<br>
m [4] = e → (101) 10 = (01100101) 2<br>
m [5] = s → (115) 10 = (01110011) 2<br>
m [6] = o → (111) 10 = (01101111) 2<br>
m [7] = r → (114) 10 = (01110010) 2<br>
<br>
1) r [0] = 01010000 XOR 00110001 = (1100001) 2 = (97) 10 → a<br>
2) r [1] = 01110010 XOR00 110001 = (1000011) 2 = (67) 10 → C<br>
3) r [2] = 01101111XOR 00110001 = (1011110) 2 = (94) 10 → ^<br>
4) r [3] = 01100011 XOR 110001 = (1010010) 2 = (82) 10 → R<br>
5) r [4] = 01100101 XOR 110001 = (1010100) 2 = (84) 10 → T<br>
6) r [5] = 01110011 XOR 110001 = (1000010) 2 = (66) 10 → B<br>
7) r [6] = 01101111 XOR 110001 = (1011110) 2 = (94) 10 → ^<br>
8) r [7] = 01110010 XOR 110001 = (1000011) 2 = (67) 10 → C<br>
<br>
So the message m = "Processor" encrypted is "aC^RTB^C"<br>
<br>

##### DECRIPTARE<br>            
Cript r = aC^RTB^C;<br>
K=17;<br>
S= 02345671<br><br>

|     S    |     0     |     2     |     3     |     4     |     5     |     6     |     7     |     1     |
|----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
|     K    |     49    |     49    |     55    |     49    |     55    |     49    |     55    |     55    |

<br>

Initially i = 0, j = 0.<br>
i = (i + 1) mod 8 = 1 mod 8 = 1.<br>
j = (j + S [i]) mod 8 = (j + S [1]) mod 8 = (0 + 2) mod 8 = 2<br>
SWAP (S [i], S [j]) mod 8 = (3 + 2) mod 8 = 5<br>
K [t] = K [5] = (49) 2 = (00110001) 2<br>
<br>
i = chr(ord(r)) XOR K[t]<br>
r[0] = a → (97)10 = (01100001)2<br>
r[1] = C → (67)10 = (11000011)2<br>
r[2] = ^ → (94)10 = (1011110)2<br>
r[3] = R → (82)10 = (1010010)2<br>
r[4] = T → (84)10 = (1010100)2<br>
r[5] = B→ (66)10 = (1000010)2<br>
r[6] = ^ → (94)10 = (1011110)2<br>
r[7] = C → (67)10 = (1000011)2<br>
<br>
1)	m[0] = 01100001 XOR 00110001 = (1010000)2 = (80)10 → P<br>
2)	m[1] = 11000011 XOR 110001 = (01110010)2 = (114)10 → r<br>
3)	m[2] = 1011110 XOR 110001 = (01101111)2 = (111)10 → o<br>
4)	m[3] = 1010010 XOR 110001 = (01100011)2 = (99)10 → c<br>
5)	m[4] = 1010100 XOR 110001 = (01100101)2 = (101)10 → e<br>
6)	m[5] = 1000010XOR 110001 = (01110011)2 = (115)10 → s<br>
7)	m[6] = 1011110 XOR 110001 = (01101111)2 = (111)10 → o<br>
8)	m[7] = 1000011XOR 110001 = (01110010)2 = (114)10 → r<br>
<br>
The encrypted message r = "aC ^ RTB ^ C" decrypted will be: "Processor".

